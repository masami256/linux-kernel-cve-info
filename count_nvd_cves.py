#!/usr/bin/env python3

# SPDX-License-Identifier: MIT

import sys
import os

current_file_path = os.path.abspath(__file__)
sys.path.append(current_file_path)

import common

def main():

    conn = common.connect()
    
    years = common.get_published_dates(conn)
    data = common.count_cves_by_years(conn, years)

    output = "nvd_cves.csv"
    with open(output, "w") as f:
        f.write("year, count\n")
        for year in data:
            f.write(f"{year},{data[year]}\n")
    
    print(f"Result is stored in {output}")
    
if __name__ == "__main__":
    main()
